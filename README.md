# GTA San Andreas Savegame Editor - Nix Flake

A Nix flake for packaging the [GTA San Andreas Savegame Editor](https://github.com/gtasa-savegame-editor/gtasa-savegame-editor).

## Features

- **Maven-based build** using `maven.buildMavenPackage`
- **Desktop integration** with `.desktop` file and application icon
- **Version detection** via embedded `git.properties` file
- **JRE wrapper** for easy command-line execution
- **Reproducible builds** with locked dependency hashes

## Building

Build the package:

```bash
nix build
```

## Running

Run the application directly:

```bash
nix run
```

Or invoke the installed binary:

```bash
./result/bin/gtasa-savegame-editor
```

## Installation

To use this flake in your NixOS configuration or Home Manager setup:

### As a package

```nix
{
  inputs = {
    gtasa-editor.url = "github:aidenscott2016/gtasa-savegame-editor-nix";
  };

  outputs = { self, nixpkgs, gtasa-editor }:
    {
      # Use gtasa-editor.packages.${system}.default
    };
}
```

### Development environment

Enter a development shell:

```bash
nix flake show
```

## Technical Details

### Build Process

1. Fetches source from GitHub tag `v3.3-rc.26`
2. Runs Maven build with tests and git-commit-id-plugin disabled
3. Injects `git.properties` file into the JAR for version detection
4. Installs JAR to `$out/share/java/`
5. Creates wrapper script at `$out/bin/gtasa-savegame-editor`
6. Installs desktop file and application icon

### Version Detection

The application originally reads its version from a `git.properties` file generated by the Maven git-commit-id-plugin. Since this plugin is disabled in the Nix build environment, we:

1. Create a minimal `git.properties` file with the correct version tag
2. Inject it into the JAR after the Maven build completes
3. This allows the application to display the correct version (3.3-rc.26) instead of 0.00

## License

This flake is licensed under the MIT License, matching the upstream project.

## Source

- **Upstream**: https://github.com/gtasa-savegame-editor/gtasa-savegame-editor
- **This flake**: https://github.com/aidenscott2016/gtasa-savegame-editor-nix
